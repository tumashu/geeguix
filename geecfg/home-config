;;; -*- mode: scheme; -*-

;; This "home-environment" file can be passed to 'guix home reconfigure'
;; to reproduce the content of your profile.  This is "symbolic": it only
;; specifies package names.  To reproduce the exact same profile, you also
;; need to capture the channels being used, as returned by "guix describe".
;; See the "Replicating Guix" section in the manual.

(use-modules
 (gnu home)
 (gnu packages)
 (gnu services)
 (guix gexp)
 (gnu home services)
 (gnu home services shells))

(home-environment
 (packages
  (map (compose list specification->package+output)
       (list "bash"
             "bash-completion"
             "p7zip"
             "unrar"
             "zip"
             "ungoogled-chromium"
             "gimp"
             "cheese"
             ;; "firefox"
             "unzip"
             "font-wqy-microhei"
             "fcitx5-chinese-addons"
             "fcitx5-configtool"
             "fcitx5"
             "zile"
             "gparted"
             "file-roller"
             "icecat"
             "libreoffice"
             "mercurial"
             "git"
             "emacs")))
 (services
  (list (service
         home-bash-service-type
         (home-bash-configuration
          (guix-defaults? #t)
          (bash-profile
           (list (plain-file "home-bash-profile"
                             "
# Source profile of guix.
export GUIX_PROFILE=\"${HOME}/.guix-profile\"
source \"${GUIX_PROFILE}/etc/profile\"")))
          (aliases
           '(("la" . "ls -A")
             ("l"  . "ls -CF")
             ("iguix-pull"       . "guix pull --allow-downgrades")
             ("ichannel-link"    . "rm -f $HOME/.config/guix/channels.scm; ln -s $HOME/guix/geeguix/geecfg/channel $HOME/.config/guix/channels.scm")
             ("isystem-reconfig" . "sudo guix system reconfigure --allow-downgrades $HOME/guix/geeguix/geecfg/system-config")
             ("ihome-reconfig"   . "guix home reconfigure $HOME/guix/geeguix/geecfg/home-config")))
          (environment-variables
           '(;; Fcitx5 input method
             ("GTK_IM_MODULE" . "fcitx")
	     ("QT_IM_MODULE"  . "fcitx")
	     ("XMODIFIERS"    . "@im=fcitx")

             ;; use "/run/current-system/profile/" if install fcitx in system.
	     ("GUIX_GTK2_IM_MODULE_FILE" . "${GUIX_PROFILE}/lib/gtk-2.0/2.10.0/immodules-gtk2.cache")
	     ("GUIX_GTK3_IM_MODULE_FILE" . "${GUIX_PROFILE}/lib/gtk-3.0/3.0.0/immodules-gtk3.cache")

             ;; Caja extension of mate desktop.
             ("CAJA_EXTENSION_DIRS"      .  "${GUIX_PROFILE}/lib/caja/extensions-2.0:/run/current-system/profile/lib/caja/extensions-2.0")

             ;; Environment variables use by guix system.
             ("GUIX_PACKAGE_PATH"        . "${HOME}/guix/geeguix:${HOME}/guix/nonguix:${GUIX_PACKAGE_PATH}"))))))))
